{% load movie_tag %}
{% load static %}

<nav class="navbar navbar-expand-lg navbar-dark">
  <a class="navbar-brand brand" href="/"><strong>S</strong>earch <strong>M</strong>ovies</a>

    <!-- кнопка поиска для мобильных в navbar -->
    <div class="col d-flex flex-row-reverse d-lg-none">
       <a class="nav-link" data-toggle="collapse" href="#collapseSearch" role="button" aria-expanded="false" aria-controls="collapseSearch">
           <i class="fa fa-search search-icon"></i>
       </a>
    </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mx-auto">
        <!-- фильмы -->
      <li class="nav-item active dropdown mr-2">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-film fa-fw mr-2"></i>
          Фильмы
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            <div class="d-lg-flex dropdown-menu-content">
                <div>
                    <div class="dropdown-divider mt-0"></div>
                    <h6 class="dropdown-header">Жанры</h6>
                    <div class="dropdown-divider"></div>
                    <div style="height: 88%; overflow-y: auto;">
                    {% get_genres as genres %}
                    {% for genre in genres %}
                        <a class="dropdown-item" href="{{ genre.get_absolute_url }}">{{ genre|title }}</a>
                    {% endfor %}
                    </div>
                </div>
                <div>
                    <div class="dropdown-divider mt-0"></div>
                    <h6 class="dropdown-header">По годам</h6>
                    <div class="dropdown-divider"></div>
                    <div style="height: 88%; overflow-y: auto;">
                    {% get_years as years %}
                    {% for year in years %}
                        <a class="dropdown-item" href="{% url 'movies_years_list' year=year %}">{{ year }}</a>
                    {% endfor %}
                    </div>
                </div>
                <div>
                    <div class="dropdown-divider mt-0"></div>
                    <h6 class="dropdown-header">По странам</h6>
                    <div class="dropdown-divider"></div>
                    <div style="height: 88%; overflow-y: auto;">
                    {% get_countries as countries %}
                    {% for country in countries %}
                        <a class="dropdown-item" href="{% url 'movies_country_list' country=country %}">{{ country }}</a>
                    {% endfor %}
                    </div>
                </div>
            </div>
        </div>
      </li>
        <!-- сериалы -->
      <li class="nav-item active mr-2">
          <a class="nav-link" href="#">
              <i class="fas fa-ellipsis-h fa-fw mr-2"></i>
              Сериалы
          </a>
      </li>
        <!-- новинки -->
      <li class="nav-item active mr-2">
          <a class="nav-link" href="{% url 'new-movies-series' %}">
              <i class="far fa-grin-hearts fa-fw mr-2"></i>
              Новинки
          </a>
      </li>
        <!-- топ -->
      <li class="nav-item active dropdown mr-2">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-fire fa-fw mr-2"></i>
          Топ
        </a>
        <div class="dropdown-menu dropdown-menu-top" aria-labelledby="navbarDropdown">
            <div class="dropdown-divider mt-0"></div>
            <a class="dropdown-item dropdown-header" href="#">
                <i class="fas fa-fire mr-1"></i>
                По годам
            </a>
            <a class="dropdown-item dropdown-header" href="{% url 'russian-classics' %}">
                <i class="fas fa-fire mr-1"></i>
                Российская класика
            </a>
            <a class="dropdown-item dropdown-header" href="{% url 'foreign-classics' %}">
                <i class="fas fa-fire mr-1"></i>
                Зарубежная класика
            </a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="{% url 'by-rating-kp' %}">По Рейтингу Кинопоиск</a>
            <a class="dropdown-item" href="{% url 'by-rating-imdb' %}">По Рейтингу IMDb</a>
            <a class="dropdown-item" href="#">Топ фильмы</a>
            <a class="dropdown-item" href="#">Топ Сериалы</a>
            <a class="dropdown-item" href="{% url 'cartoon' %}">Топ Мультфильмы</a>
        </div>
      </li>
        <!-- случайный фильм -->
      <li class="nav-item active">
          {% get_random_movie_or_series as random_movie_or_series %}
          <a class="nav-link random-film" href="{{random_movie_or_series.get_absolute_url}}">
            <i class="fas fa-dice fa-fw mr-1"></i>
            Случайный фильм
          </a>
      </li>
    </ul>

    <ul class="navbar-nav">
       <!-- collapse форма поиска -->
      <li class="nav-item mr-3 d-none d-lg-block">
          <a class="nav-link" data-toggle="collapse" href="#collapseSearch" role="button" aria-expanded="false" aria-controls="collapseSearch">
              <i class="fa fa-search search-icon"></i>
          </a>
      </li>
        <!-- login -->
        {% if user.is_authenticated %}
            <!-- для декстопа -->
        <li class="nav-item active drop d-none d-lg-block">
          <div class="d-flex">
          <div class="user-avatar">
              <img src="{{ user.profile.avatar.url }}">
          </div>
            <a class="nav-link text-white" href="">{{ user.username }}</a>
          </div>

          <div class="triangle"></div>
          <div class="dropdownContain">
            <div class="dropOut">
              <ul>
                <li><a aria-hidden="true" href="{% url 'accounts_profile' %}"> Профиль</a></li>
                {% if user.is_superuser %}
                <li><a aria-hidden="true" href="{% url "admin:index" %}"> Админ панель</a></li>
                {% endif %}
                <li><a aria-hidden="true" href="{% url 'accounts_profile_favorites' %}"> Избранное</a></li>
                <li><a aria-hidden="true" href="{% url 'accounts_profile_settings' %}">Настройки</a> </li>
                <li><a aria-hidden="true" href="{% url 'account_logout' %}"> Выйти</a> </li>
              </ul>
            </div>
          </div>
        </li>
         <!-- для мобильных -->
         <li class="nav-item active mr-2 d-lg-none">
              <a class="nav-link" href="{% url 'accounts_profile' %}">
                  <i class="fas fa-user-circle fa-fw mr-2"></i>
                  Профиль
              </a>
         </li>

         <li class="nav-item active mr-2 d-lg-none">
              <a class="nav-link" href="{% url 'account_logout' %}">
                  <i class="fas fa-sign-out-alt fa-fw mr-2" aria-hidden="true"></i>
                  Выйти
              </a>
         </li>

        {% else %}
       <li class="nav-item active">
          <a class="nav-link" href="{% url 'account_login' %}">Войти</a>
        </li>
        {% endif %}

      </ul>
  </div>
</nav>
<!-- collapse форма поиска -->
<section class="container">
   <div class="row">
       <div class="col-lg-12 col-xl-12">
           <div class="collapse" id="collapseSearch">
               <div class="card-body border-0 nav-search">
                   <form method="post" role="search">
                       <input class="form-control bg-dark border-dark position-relative" type="search" placeholder="Поиск" aria-label="Search">
                       <a class="btn btn-search position-absolute" type="submit"><i class="fa fa-search search-icon" ></i></a>
                   </form>
               </div>
           </div>
       </div>
   </div>
</section>